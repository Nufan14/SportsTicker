<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <style>
        body { background: #050505; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; color: #eee; overflow: hidden; }
        .header { 
            background: linear-gradient(135deg, #1a237e, #4a148c); 
            color: white; padding: 12px; text-align: center; border-radius: 6px; 
            font-weight: 800; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 10px;
            border: 1px solid #3949ab;
        }
        #content { display: flex; flex-direction: column; gap: 6px; }
        .row { 
            background: rgba(25, 25, 25, 0.9); display: flex; align-items: center; padding: 8px 15px; 
            border-radius: 6px; border-left: 4px solid #3949ab; height: 42px;
        }
        .label { width: 85px; font-size: 0.65rem; color: #aaa; font-weight: bold; text-transform: uppercase; overflow: hidden; white-space: nowrap; }
        .status { width: 100px; font-size: 0.7rem; color: #00e676; font-weight: bold; }
        .match { flex: 1; display: flex; align-items: center; justify-content: space-between; gap: 10px; }
        .tm { display: flex; align-items: center; gap: 8px; flex: 1; font-size: 0.9rem; font-weight: 600; }
        .tm.h { justify-content: flex-end; text-align: right; }
        .tm.a { justify-content: flex-start; text-align: left; }
        .score { 
            background: #1a1a1a; padding: 3px 10px; border-radius: 15px; min-width: 60px; 
            text-align: center; font-weight: 800; color: #ffeb3b; border: 1px solid #444;
        }
        img.logo { width: 24px; height: 24px; object-fit: contain; }
    </style>
</head>
<body>
    <div class="header">‚≠ê FEATURED MAIN EVENTS</div>
    <div id="content"></div>

    <script>
        async function getStats() {
            const list = document.getElementById('content');
            // This is ESPN's "Featured" headline scoreboard endpoint
            const url = 'https://site.web.api.espn.com/apis/v2/scoreboard/header';

            try {
                const res = await fetch(`${url}?cb=${Date.now()}`);
                const data = await res.json();
                
                if (!data.sports) return;

                let events = [];
                data.sports.forEach(sport => {
                    sport.leagues.forEach(league => {
                        if (league.events) {
                            league.events.forEach(e => {
                                events.push({
                                    leagueName: league.shortName || sport.name,
                                    event: e,
                                    date: new Date(e.date)
                                });
                            });
                        }
                    });
                });

                // Priority Sort: Live events first, then by start time
                events.sort((a, b) => {
                    const aLive = a.event.fullStatus.type.state === 'in';
                    const bLive = b.event.fullStatus.type.state === 'in';
                    if (aLive && !bLive) return -1;
                    if (!aLive && bLive) return 1;
                    return a.date - b.date;
                });

                list.innerHTML = events.slice(0, 10).map(item => {
                    const e = item.event;
                    const stat = e.fullStatus.type;
                    const home = e.competitors.find(c => c.homeAway === 'home') || e.competitors[0];
                    const away = e.competitors.find(c => c.homeAway === 'away') || e.competitors[1];

                    const scoreStr = stat.state === 'pre' ? 'VS' : `${home.score} - ${away.score}`;

                    return `
                        <div class="row">
                            <div class="label">${item.leagueName}</div>
                            <div class="status" style="color: ${stat.state === 'in' ? '#ff5252' : '#00e676'}">
                                ${stat.shortDetail}
                            </div>
                            <div class="match">
                                <div class="tm h"><span>${home.displayName}</span><img src="${home.logo || ''}" class="logo" onerror="this.style.display='none'"></div>
                                <div class="score">${scoreStr}</div>
                                <div class="tm a"><img src="${away.logo || ''}" class="logo" onerror="this.style.display='none'"><span>${away.displayName}</span></div>
                            </div>
                        </div>`;
                }).join('');

            } catch (err) {
                console.error("Failed to fetch main events:", err);
            }
        }

        getStats();
        setInterval(getStats, 60000);
    </script>
</body>
</html>
