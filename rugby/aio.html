<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        body { background: #f0f0f0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 10px; }
        .header { background: #1a1a1a; color: #fff; padding: 15px; text-align: center; border-radius: 8px; margin-bottom: 15px; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; border-bottom: 4px solid #d41111; }
        .main-container { display: grid; grid-template-columns: 1.5fr 1fr; gap: 15px; }
        .section { background: white; border-radius: 8px; padding: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .section-title { font-size: 0.9rem; font-weight: 800; color: #d41111; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 5px; text-transform: uppercase; }
        
        /* Game Rows */
        .game-row { display: flex; align-items: center; justify-content: space-between; padding: 8px; border-bottom: 1px solid #f9f9f9; font-size: 0.85rem; }
        .team-info { display: flex; align-items: center; gap: 8px; flex: 1; }
        .team-logo { width: 24px; height: 24px; object-fit: contain; }
        .score { font-weight: 900; background: #333; color: white; padding: 2px 8px; border-radius: 4px; min-width: 30px; text-align: center; }
        .status { font-size: 0.7rem; color: #666; width: 60px; text-align: right; font-weight: bold; }

        /* Standings Table */
        table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
        th { text-align: left; color: #999; font-size: 0.7rem; padding: 5px; }
        td { padding: 6px 5px; border-bottom: 1px solid #eee; }
        .rank { font-weight: bold; color: #d41111; width: 20px; }
        .pts { font-weight: bold; background: #fdf2f2; }

        #live-section { grid-column: span 2; display: none; margin-bottom: 15px; }
        .live-card { background: #fff5f5; border: 2px solid #d41111; }
    </style>
</head>
<body>

<div class="header">ðŸ‡«ðŸ‡· TOP 14 RUGBY</div>

<div id="live-section" class="section live-card">
    <div class="section-title">ðŸ”´ LIVE NOW</div>
    <div id="live-games"></div>
</div>

<div class="main-container">
    <div class="section">
        <div class="section-title">ðŸ“… SCHEDULE & RESULTS</div>
        <div id="scores-container"></div>
    </div>

    <div class="section">
        <div class="section-title">ðŸ“Š STANDINGS</div>
        <div id="standings-container">
            <table>
                <thead>
                    <tr><th>#</th><th>TEAM</th><th>PL</th><th>PTS</th></tr>
                </thead>
                <tbody id="standings-body"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // Specific slug for French Top 14
    const LEAGUE_SLUG = "fra.1"; 

    async function getScores() {
        try {
            const ts = Date.now();
            // Use the broader scoreboard endpoint
            const res = await fetch(`https://site.api.espn.com/apis/site/v2/sports/rugby/score/scoreboard?league=${LEAGUE_SLUG}&cb=${ts}`);
            const data = await res.json();
            
            const liveDiv = document.getElementById('live-games');
            const scoresDiv = document.getElementById('scores-container');
            const liveSection = document.getElementById('live-section');
            
            let liveHTML = "";
            let gamesHTML = "";
            let liveCount = 0;

            if (data.events && data.events.length > 0) {
                data.events.forEach(event => {
                    const status = event.status.type.state;
                    const teams = event.competitions[0].competitors;
                    const home = teams.find(t => t.homeAway === 'home');
                    const away = teams.find(t => t.homeAway === 'away');
                    const clock = event.status.type.shortDetail;

                    const row = `
                        <div class="game-row">
                            <div class="team-info">
                                <img class="team-logo" src="${away.team.logo || ''}">
                                <span>${away.team.shortDisplayName || away.team.name}</span>
                            </div>
                            <div class="score">${status === 'pre' ? 'VS' : away.score + ' - ' + home.score}</div>
                            <div class="team-info" style="justify-content: flex-end;">
                                <span>${home.team.shortDisplayName || home.team.name}</span>
                                <img class="team-logo" src="${home.team.logo || ''}">
                            </div>
                            <div class="status">${clock}</div>
                        </div>`;

                    if (status === 'in') {
                        liveHTML += row;
                        liveCount++;
                    } else {
                        gamesHTML += row;
                    }
                });
            } else {
                gamesHTML = "<div style='text-align:center; padding:20px; color:#999;'>No recent matches found.</div>";
            }

            liveDiv.innerHTML = liveHTML;
            scoresDiv.innerHTML = gamesHTML;
            liveSection.style.display = liveCount > 0 ? 'block' : 'none';
        } catch (e) { console.error("Rugby Score Error:", e); }
    }

    async function getStandings() {
        try {
            const ts = Date.now();
            // Note: Rugby standings often live under a different organization in the API
            const res = await fetch(`https://site.api.espn.com/apis/site/v2/sports/rugby/score/standings?league=${LEAGUE_SLUG}&cb=${ts}`);
            const data = await res.json();
            const body = document.getElementById('standings-body');
            
            let html = "";
            
            // Navigate the nested structure specifically for Rugby
            const standingsData = data.children && data.children[0] ? data.children[0].standings.entries : [];
            
            if (standingsData.length > 0) {
                standingsData.forEach((entry, idx) => {
                    const team = entry.team;
                    const stats = entry.stats;
                    
                    // Rugby stats names can differ: 'gamesPlayed' and 'points' are standard
                    const played = stats.find(s => s.name === 'gamesPlayed')?.displayValue || '0';
                    const points = stats.find(s => s.name === 'points')?.displayValue || '0';

                    html += `
                        <tr>
                            <td class="rank">${idx + 1}</td>
                            <td style="display:flex; align-items:center; gap:5px;">
                                <img src="${team.logos ? team.logos[0].href : ''}" style="width:18px;height:18px;">
                                ${team.shortDisplayName || team.name}
                            </td>
                            <td>${played}</td>
                            <td class="pts">${points}</td>
                        </tr>`;
                });
            } else {
                html = "<tr><td colspan='4' style='text-align:center;'>Standings currently unavailable</td></tr>";
            }
            body.innerHTML = html;
        } catch (e) { console.error("Rugby Standings Error:", e); }
    }

    getScores();
    getStandings();
    setInterval(getScores, 60000); 
</script>
