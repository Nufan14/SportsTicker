<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <style>
        body { background: #f0f2f5; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; }
        .main-wrapper { max-width: 1100px; margin: 0 auto; }
        .section-header { 
            background: #1a1a1a; color: white; padding: 10px; text-align: center; 
            border-radius: 6px; font-weight: bold; margin: 15px 0 10px 0; font-size: 0.9rem;
        }
        .columns-grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; }
        .game-card {
            background: white; border-radius: 8px; margin-bottom: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05); display: flex; flex-direction: column;
            border: 1px solid #e0e0e0;
        }
        .row-content { display: flex; align-items: center; justify-content: space-between; padding: 10px 15px; }
        .status-tag { width: 55px; font-size: 0.75rem; color: #d32f2f; font-weight: bold; }
        .team-unit { display: flex; align-items: center; gap: 8px; width: 40%; }
        .team-unit.home { justify-content: flex-end; text-align: right; }
        .team-unit.away { justify-content: flex-start; text-align: left; }
        .team-label { font-size: 0.9rem; font-weight: 600; color: #333; }
        .score-display { background: #222; color: #fff; min-width: 65px; text-align: center; font-weight: 800; padding: 5px 0; border-radius: 4px; font-family: monospace; }
        .scorer-footer {
            background: #f9f9f9; padding: 6px 15px; font-size: 0.7rem; color: #666; 
            border-top: 1px solid #eee; border-bottom-left-radius: 8px; border-bottom-right-radius: 8px;
        }
        @media (max-width: 800px) { .columns-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="main-wrapper">
        <div id="live-area">
            <div class="section-header">ðŸ”´ LIVE MATCHES</div>
            <div id="liveGamesContainer"></div>
        </div>
        <div class="columns-grid">
            <div>
                <div class="section-header">âœ… RECENT RESULTS</div>
                <div id="finishedGamesContainer"></div>
            </div>
            <div>
                <div class="section-header">ðŸ“… UPCOMING FIXTURES</div>
                <div id="scheduledGamesContainer"></div>
            </div>
        </div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        let leagueId = params.get('league') || 'eng.1';

        async function fetchSoccer() {
            try {
                const now = new Date();
                const start = new Date(now.getTime() - (3 * 24 * 60 * 60 * 1000)).toISOString().split('T')[0].replace(/-/g, "");
                const end = new Date(now.getTime() + (5 * 24 * 60 * 60 * 1000)).toISOString().split('T')[0].replace(/-/g, "");
                
                const res = await fetch(`https://site.api.espn.com/apis/site/v2/sports/soccer/${leagueId}/scoreboard?dates=${start}-${end}&limit=100`);
                const data = await res.json();
                
                const containers = {
                    'in': document.getElementById('liveGamesContainer'),
                    'pre': document.getElementById('scheduledGamesContainer'),
                    'post': document.getElementById('finishedGamesContainer')
                };
                
                Object.values(containers).forEach(c => c.innerHTML = '');

                if (!data.events || data.events.length === 0) return;

                data.events.forEach(event => {
                    const status = event.status.type.state;
                    const home = event.competitions[0].competitors[0];
                    const away = event.competitions[0].competitors[1];
                    
                    let scorersHtml = "";
                    if (status === 'post' && event.competitions[0].details) {
                        const goals = event.competitions[0].details
                            .filter(d => d.type.text === "Goal")
                            .map(d => d.athlete.displayName + " (" + d.clock.displayValue + ")")
                            .join(", ");
                        if (goals) scorersHtml = `<div class="scorer-footer">âš½ ${goals}</div>`;
                    }

                    const card = document.createElement('div');
                    card.className = 'game-card';
                    card.innerHTML = `
                        <div class="row-content">
                            <div class="status-tag">${event.status.type.shortDetail}</div>
                            <div class="team-unit home">
                                <span class="team-label">${home.team.shortDisplayName || home.team.name}</span>
                                <img src="${home.team.logo}" width="20">
                            </div>
                            <div class="score-display">${status === 'pre' ? 'VS' : home.score + ' - ' + away.score}</div>
                            <div class="team-unit away">
                                <img src="${away.team.logo}" width="20">
                                <span class="team-label">${away.team.shortDisplayName || away.team.name}</span>
                            </div>
                        </div>
                        ${scorersHtml}
                    `;

                    if (containers[status]) {
                        if (status === 'post' && containers.post.children.length < 10) containers.post.appendChild(card);
                        else if (status === 'pre' && containers.pre.children.length < 10) containers.pre.appendChild(card);
                        else if (status === 'in') containers.in.appendChild(card);
                    }
                });
            } catch (e) { console.error(e); }
        }
        fetchSoccer();
        setInterval(fetchSoccer, 60000);
    </script>
</body>
</html>
